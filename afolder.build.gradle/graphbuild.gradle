
println "configuration"
println "gradle id: ${gradle.hashCode()}"
println "hashCode: ${hashCode()}"
println "root: ${rootProject.hashCode()}, ${project.hashCode()}, ${gradle.rootProject.hashCode()}"
println gradle.taskGraph.allTasks

task hello(description: "Hello task", group: "dmdev", type: DefaultTask) {
    println "configuration phase. Task hello"

    doLast {
        println "execution phase, Action 1"
    }
    doFirst {
        println "execution phase, Action 2"
    }
    doLast {
        println "execution phase, Action 3"
    }
    println "task: $description, group: $group, actions: ${actions.size()}"
    println "path task: $path"
}

task first (group: "dmdev"){
    doLast {
        println "Task 1"
    }
}

task second {
    doLast {
        println "Task 2"
    }
}

task third {
    doLast {
        println "Task 3"
    }
}

task fourth {
    doLast {
        println "Task 4"
    }
}

// 2 <--- 4

//fourth.dependsOn(second,first,third)
//------
//fourth.dependsOn second
//second.dependsOn first // - second after first
//second.finalizedBy third //- second before third
//1->2->3->4

// 2
// 1    4
// 3
fourth.dependsOn first
fourth.dependsOn second
fourth.dependsOn third

first.mustRunAfter second

gradle.taskGraph.whenReady { TaskExecutionGraph graph ->
    println "---Graph:"
    graph.allTasks.forEach {
        println "${it.name}"
    }
}

gradle.taskGraph.beforeTask { Task task ->
    if (task.group == 'dmdev') {
        println "beforeTask callBack $task"
    }
}

gradle.taskGraph.afterTask { Task task ->
    if (task.name == 'first') {
        println "afterTask callBack $task"
    }
}

defaultTasks "fourth"